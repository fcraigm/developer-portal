---
title: Extensions
description: |
  Extensions sind der ideale Weg, das mStudio um Funktionen zu erweitern, die nicht von mittwald bereitgestellt werden. Dieser Abschnitt wird dich dabei begleiten, Extensions zu verstehen und Eigene zu entwickeln.
---

# Extensions

Extensions sind der ideale Weg, das mStudio um Funktionen zu erweitern, die nicht von mittwald bereitgestellt werden. Dieser Abschnitt wird dich dabei begleiten, Extensions zu verstehen und Eigene zu entwickeln.

## Zuerst einige Definitionen

### Contributor

Ausgewählte Organisationen können als `Contributor` Extensions für das mStudio und dessen Benutzer bereitstellen.

### Extension

Eine `Extension` ist eine Erweiterung des mStudio, die von einem Contributor bereitgestellt wird. Sie bietet Möglichkeiten, authentifiziert und authorisiert die öffentliche mittwald API zu bedienen.

### Extension-Context

Extensions können entweder zu einem Projekt oder zu einer Organisation hinzugefügt werden. Dies verallgemeinern wir unter dem Begriff `Extension-Context`. Als Contributor entscheidest du, für welchen Extension-Context deine Extension verfügbar sein soll.

### Extension-Instance

Wenn du eine Extension zu einem Extension-Context hinzufügst, wird eine `Extension-Instance` erstellt. Zum Beispiel wird beim Hinzufügen einer Extension zu einem Projekt eine Extension-Instance für dieses Projekt erstellt. Wenn dieselbe Extension zu einem anderen Projekt hinzugefügt wird, wird eine weitere Extension-Instance für das zweite Projekt erstellt. Dies ist wichtig, weil jede Extension-Instance ihre eigene ID, Konfiguration, zugestimmte Scopes usw. hat.

### Scope

Ein `Scope` ist ein Satz von Berechtigungen, den eine Extension anfordern kann. Wenn eine Extension zu einem Extension-Context hinzugefügt wird, muss allen angeforderten Scopes zugestimmt werden.

### Domain Action

`Domain Action` ist ein universeller Begriff für einen beliebigen Request, wie z.B. das Erstellen eines neuen Projekts oder das Einladen eines Benutzers in eine Organisation, der an unsere öffentliche API gestellt wird.

## Bestandteile einer Extension

Eine Extension besteht zum aktuellen Zeitpunkt aus einer externen Anwendung, die im Folgenden beschrieben wird. Weitere Bestandteile werden folgen.

### Externe Anwendung

Eine Externe Anwendung kann überall gehostet werden. Sie besteht aus mindestens einem öffentlich erreichbaren Backend und bietet einen Endpunkt, der für Lebenszyklus-Ereignisse von Extension-Instances durch mittwald aufgerufen wird. Über diese Lebenszyklus-Ereignisse erhält die Externe Anwendung alle nötigen Informationen, um ein Extension-Access-Token abzurufen und Domain Actions im Namen der Extension-Instance auszuführen.

## Ausführen von authentifizierten Domain Actions ...

### ... als mStudio-Benutzer durch eine externe Anwendung

Um einen mStudio-Benutzer im Context einer externen Anwendung zu authentifizieren, sind zwei Möglichkeiten vorgesehen.

Erstens kannst du als Contributor eine URL (oder ein URL-Template) für die Extension bereitstellen, die der Benutzer über eine Schaltfläche im mStudio aufrufen kann, um zur externen Anwendung weitergeleitet zu werden. Während der Weiterleitung stellen wir einen Access Token Retrieval Key als Query-Parameter bereit. Die externe Anwendung kann diesen verwenden, um das eigentliche Access Token zum Authentifizieren gegen die öffentliche API abzurufen.

Zweitens kann die externe Anwendung den mStudio OAuth2-Authentifizierungsablauf verwenden. Weitere Details dazu werden in Zukunft bereitgestellt, da dies noch nicht vollständig ausgearbeitet ist.

Das direkte Abfragen der mStudio-Anmeldeinformationen ist keine Methode, die wir akzeptieren, da wir dem Benutzer nicht beibringen möchten, seine Anmeldeinformationen an eine Drittanbieteranwendung weiterzugeben.

Nach erfolgreicher Authentifizierung kann der mStudio-Benutzer Domain Actions ausführen. Beachte, dass dies aufgrund von CORS-Einschränkungen derzeit nur über ein externes _Backend_ möglich ist. Außerdem ist zu beachten, dass der Benutzer in diesem Anwendungsfall mit exakt den gleichen Rechten wie im mStudio - also als der Benutzer selbst - auftritt.

### ... als autonom agierende externe Anwendung

Die Durchführung einer Domain Action als externe Anwendung ohne Benutzerkontext ist der Hauptanwendungsfall für Extensions, die Funktionen bereitstellen, die nicht direkt mit der manuellen Interaktion eines Users verknüpft sind. Zu diesem Zweck kann das zuvor über das entsprechende Lebenszyklus-Ereignis mitgeteilte Secret verwendet werden, um ein Extension Access Token abzurufen. Dieses Access Token kann verwendet werden, um Domain Actions auszuführen.

### ... als externe Anwendung mit eigener Nutzerverwaltung

Analog zur zuvor beschriebenen Methode kann der gleiche Prozess verwendet werden, um eine eigene Nutzerverwaltung bereitzustellen. Nutzer, die von der externen Anwendung registriert werden, kommunizieren alle im Namen der Extension-Instance und teilen sich unterliegend dasselbe Extension Secret.

### ... als mStudio-Benutzer im Namen einer Extension-Instance

Um Domain Actions als registrierter mStudio-Benutzer, aber im Namen und nur mit Berechtigungen einer Extension-Instance durchzuführen, benötigt der Benutzer ein gültiges User-Access-Token (für Externe Anwendungen siehe oben) und die spezifische Extension-Instance ID. Mit diesen Parametern kann der Benutzer Domain Actions ausführen. Dabei stellt mittwald sicher, dass nicht nur die Extension-Instance, sondern auch der Benutzer selbst zur Ausführung der Domain Action berechtigt ist und Zugriff auf die Extension-Instance hat.

Dieser Ablauf ist interessant für Externe Anwendungen, die eine Mischung aus den vorherigen Ansätzen darstellen (z.B. um ein Admin-Panel für mStudio-Benutzer und ein Benutzer-Panel für extension-seitig verwaltete Endkunden zu implementieren).
